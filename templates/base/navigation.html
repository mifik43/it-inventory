
<ul class="nav nav-pills flex-column mb-auto">
    <li class="nav-item">
        <a class="nav-link {% if request.endpoint == 'index' %}active{% endif %}" 
           href="{{ url_for('index') }}">
            <i class="bi bi-speedometer2"></i>
            Дашборд
        </a>
    </li>
    
    <!-- Serviced Items Dropdown -->
    <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle {% if request.endpoint in ['devices.devices', 'devices.add_device', 'devices.edit_device', 'providers.providers', 'providers.add_provider', 'providers.edit_provider', 'cubes.cubes', 'cubes.add_cube', 'cubes.edit_cube', 'organizations.organizations', 'organizations.add_organization', 'organizations.edit_organization', 'guest_wifi.guest_wifi', 'guest_wifi.add_guest_wifi', 'guest_wifi.edit_guest_wifi', 'wtware_list', 'add_wtware', 'edit_wtware'] %}active{% endif %}" 
       href="#" data-bs-toggle="dropdown">
        <i class="bi bi-tools"></i>
        На обслуживании
    </a>
    <ul class="dropdown-menu">
        <li>
            <a class="dropdown-item {% if request.endpoint in ['devices.devices', 'devices.add_device', 'devices.edit_device'] %}active{% endif %}" 
               href="{{ url_for('devices.devices') }}">
                <i class="bi bi-pc-display"></i> Устройства
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if request.endpoint in ['providers.providers', 'providers.add_provider', 'providers.edit_provider'] %}active{% endif %}" 
               href="{{ url_for('providers.providers') }}">
                <i class="bi bi-wifi"></i> Провайдеры
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if request.endpoint in ['guest_wifi.guest_wifi', 'guest_wifi.add_guest_wifi', 'guest_wifi.edit_guest_wifi'] %}active{% endif %}" 
               href="{{ url_for('guest_wifi.guest_wifi') }}">
                <i class="bi bi-router"></i> Гостевой WiFi
            </a>
        </li>
        <!-- ДОБАВЛЯЕМ WTWARE -->
<li>
    <a class="dropdown-item {% if request.endpoint in ['wtware_list', 'add_wtware', 'edit_wtware'] %}active{% endif %}" 
       href="{{ url_for('wtware_list') }}">
        <i class="bi bi-terminal"></i> WTware Конфигурации
    </a>
</li>
<li>
    <a class="dropdown-item {% if request.endpoint == 'wtware_deployments' %}active{% endif %}" 
       href="{{ url_for('wtware_deployments') }}">
        <i class="bi bi-clock-history"></i> История развертываний
    </a>
</li>
        <li>
            <a class="dropdown-item {% if request.endpoint in ['cubes.cubes', 'cubes.add_cube', 'cubes.edit_cube'] %}active{% endif %}" 
               href="{{ url_for('cubes.cubes') }}">
                <i class="bi bi-box"></i> Программы
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if request.endpoint in ['organizations.organizations', 'organizations.add_organization', 'organizations.edit_organization'] %}active{% endif %}" 
               href="{{ url_for('organizations.organizations') }}">
                <i class="bi bi-building"></i> Организации
            </a>
        </li>
    </ul>
</li>

    <!-- Knowledge Base -->
    <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle {% if request.endpoint in ['articles.articles_list', 'articles.view_article', 'articles.add_article', 'articles.edit_article', 'notes.notes_list', 'notes.add_note', 'notes.edit_note'] %}active{% endif %}" 
           href="#" data-bs-toggle="dropdown">
            <i class="bi bi-journal-text"></i>
            База знаний
        </a>
        <ul class="dropdown-menu">
            <li>
                <a class="dropdown-item {% if request.endpoint in ['articles.articles_list', 'articles.view_article', 'articles.add_article', 'articles.edit_article'] %}active{% endif %}" 
                   href="{{ url_for('articles.articles_list') }}">
                    <i class="bi bi-journal-text"></i> Статьи
                </a>
            </li>
            <li>
                <a class="dropdown-item {% if request.endpoint in ['notes.notes_list', 'notes.add_note', 'notes.edit_note'] %}active{% endif %}" 
                   href="{{ url_for('notes.notes_list') }}">
                    <i class="bi bi-sticky"></i> Заметки
                </a>
            </li>
        </ul>
    </li>
    
    <!-- TODO -->
     {% if 'todo_manage' in session.permissions or 'todo_read' in session.permissions %}
    <li class="nav-item">
        <a class="nav-link {% if request.endpoint in ['todo.todo', 'todo.add_todo', 'todo.edit_todo'] %}active{% endif %}" 
           href="{{ url_for('todo.todo') }}">
            <i class="bi bi-check-square"></i>
            Задачи
        </a>
    </li>
    {% endif %}

    <!-- Shifts -->
    {% if 'shifts_manage' in session.permissions or 'shifts_read' in session.permissions %}
    <li class="nav-item">
        <a class="nav-link {% if request.endpoint in ['shifts.shifts_list', 'shifts.add_shift', 'shifts.edit_shift'] %}active{% endif %}" 
           href="{{ url_for('shifts.shifts_list') }}">
            <i class="bi bi-calendar-week"></i>
            График смен
        </a>
    </li>
    {% endif %}
    <li class="nav-item">
    <a class="nav-link" href="{{ url_for('network_scan') }}">
        <i class="fas fa-network-wired"></i> Сканирование сети
    </a>
    </li>
    {% if session.role == 'admin' %}
    <li class="nav-item">
        <a class="nav-link" href="{{ url_for('scripts_list') }}">
            <i class="fas fa-terminal"></i> Скрипты
        </a>
    </li>
    {% endif %}
        <!-- roles -->
    {% if 'roles_manage' in session.permissions or 'roles_read' in session.permissions %}
    <li class="nav-item">
        <a class="nav-link {% if request.endpoint in ['roles.roles', 'roles.create_role', 'roles.edir_role'] %}active{% endif %}" 
           href="{{ url_for('roles.roles') }}">
            <i class="bi bi-calendar-week"></i>
            Роли пользователей
        </a>
    </li>
    {% endif %}
    <!-- Admin Only -->
    {% if 'users_manage' in session.permissions or 'users_read' in session.permissions %}
    <li class="nav-item">
        <a class="nav-link {% if request.endpoint in ['users.users', 'users.create_user', 'users.edit_user'] %}active{% endif %}" 
           href="{{ url_for('users.users') }}">
            <i class="bi bi-people"></i>
            Пользователи
        </a>
    </li>
    {% endif %}
</ul>
